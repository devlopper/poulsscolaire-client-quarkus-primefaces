<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core" xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:p="http://primefaces.org/ui">

  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.configuration.SchoolDto"
    var="SchoolDto" />
  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.configuration.BranchDto"
    var="BranchDto" />
  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.configuration.PeriodDto"
    var="PeriodDto" />
  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.registration.StudentDto"
    var="StudentDto" />
  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.fee.FeeCategoryDto"
    var="FeeCategoryDto" />
  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.registration.RegistrationDto"
    var="RegistrationDto" />

  <p:importConstants type="org.cyk.system.poulsscolaire.server.api.fee.AdjustedFeeDto" var="Dto" />

  <p:column headerText="#{SchoolDto.NAME}" visible="false"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_REGISTRATION_SCHOOLING_SCHOOL_AS_STRING)}">
    <h:outputText value="#{record.registrationSchoolingSchoolAsString}" />
  </p:column>
  <p:column headerText="#{BranchDto.NAME}" visible="false"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_REGISTRATION_SCHOOLING_BRANCH_AS_STRING)}">
    <h:outputText value="#{record.registrationSchoolingBranchAsString}" />
  </p:column>
  <p:column headerText="#{PeriodDto.NAME}" visible="false"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_REGISTRATION_SCHOOLING_PERIOD_AS_STRING)}">
    <h:outputText value="#{record.registrationSchoolingPeriodAsString}" />
  </p:column>
  <p:column headerText="#{StudentDto.NAME}" visible="false"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_REGISTRATION_STUDENT_AS_STRING)}">
    <h:outputText value="#{record.registrationStudentAsString}" />
  </p:column>

  <p:column headerText="#{FeeCategoryDto.NAME}" width="150px"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_FEE_AS_STRING)}">
    <ui:fragment rendered="#{record.feeOptional}">
      <p:tag severity="info" value="#{record.feeAsString}" rounded="true" />
    </ui:fragment>
    <ui:fragment rendered="#{not record.feeOptional}">
      <h:outputText value="#{record.feeAsString}" />
    </ui:fragment>
  </p:column>

  <p:column headerText="#{RegistrationDto.NAME}"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_REGISTRATION_AS_STRING)}">
    <h:outputText value="#{record.registrationAsString}" />
  </p:column>
  
  <p:column headerText="Classe" width="150px"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_BRANCH_INSTANCE_AS_STRING)}">
    <h:outputText value="#{record.branchInstanceAsString}" />
  </p:column>
  
  <p:column headerText="Réduction" width="100"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_REDUCED_AMOUNT_AS_STRING)}">
    <h:outputText value="#{record.reducedAmountAsString}" />
  </p:column>

  <p:column headerText="À payer" width="100"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_VALUE_AS_STRING)}">
    <h:outputText value="#{record.amountValueAsString}" />
    <f:facet name="footer">
      <h:outputText value="#{container.amountValueStatistics.totalAsString}" />
    </f:facet>
  </p:column>

  <p:column headerText="Payé" width="100"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_VALUE_PAID_AS_STRING)}">
    <h:outputText value="#{record.amountValuePaidAsString}" />
    <f:facet name="footer">
      <h:outputText value="#{container.amountValueStatistics.paidAsString}" />
    </f:facet>
  </p:column>

  <p:column headerText="Reste à payer" width="100"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_VALUE_PAYABLE_AS_STRING)}">
    <h:outputText value="#{record.amountValuePayableAsString}"
      rendered="#{record.amountValuePayable == null or record.amountValuePayable eq 0}" />
    <p:tag severity="warning" value="#{record.amountValuePayableAsString}"
      rendered="#{record.amountValuePayable > 0}" />
    <f:facet name="footer">
      <p:tag severity="warning" value="#{container.amountValueStatistics.payableAsString}" />
    </f:facet>
  </p:column>

  <p:column headerText="Montant Inscription" width="150" visible="false"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_REGISTRATION_VALUE_PART_AS_STRING)}">
    <h:outputText value="#{record.amountRegistrationValuePartAsString}" visible="false" />
    <f:facet name="footer">
      <h:outputText value="#{container.amountRegistrationPartStatistics.totalAsString}" />
    </f:facet>
  </p:column>

  <p:column headerText="Facultatif" width="100"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_OPTIONAL_AS_STRING)}">
    <h:outputText value="#{record.amountOptionalAsString}" />
  </p:column>

  <p:column headerText="Ordre de paiement" width="120"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_PAYMENT_ORDER_NUMBER_AS_STRING)}"
    visible="false">
    <h:outputText value="#{record.amountPaymentOrderNumberAsString}" />
  </p:column>
  
  <p:column headerText="Paiement attendu" width="100"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_EXPECTED_PAYMENT_AS_STRING)}"
    >
    <h:outputText value="#{record.expectedPaymentAsString}" />
  </p:column>
  
  <p:column headerText="Échéance" width="150"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_DEADLINE_AS_STRING)}">
    <p:tag severity="warning" value="#{record.amountDeadlineAsString}"
      rendered="#{not empty record.amountDeadlineAsString and not record.latePayment}" />
    <p:tag severity="danger" value="#{record.amountDeadlineAsString}"
      rendered="#{record.latePayment}" />
  </p:column>

  <p:column headerText="Reconductible" width="100" visible="false"
    rendered="#{listController.isReadControllerHasProjectionName(Dto.JSON_AMOUNT_RENEWABLE_AS_STRING)}">
    <h:outputText value="#{record.amountRenewableAsString}" />
  </p:column>
</ui:composition>